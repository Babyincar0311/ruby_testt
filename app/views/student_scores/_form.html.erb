<%# app/views/student_scores/_form.html.erb %>

<%= form_with(model: [@student, @student_score], local: true) do |f| %>
  <% if @student_score.errors.any? %>
    <div id="error_explanation" style="border:1px solid red; padding:10px; margin-bottom:10px;">
      <h4>⚠️ Có <%= pluralize(@student_score.errors.count, "lỗi") %>:</h4>
      <ul>
        <% @student_score.errors.full_messages.each do |msg| %>
          <li><%= msg %></li>
        <% end %>
      </ul>
    </div>
  <% end %>

  <%= f.hidden_field :student_id, value: @student.id %>

  <div>
    <%= f.label :subject_id, "Môn học" %>

    <%# Dropdown cho môn học, nhưng nếu edit thì disabled %>
    <%= f.collection_select :subject_id, @subjects, :id, :subject_name,
                            { prompt: "Chọn môn học" },
                            { disabled: @student_score.persisted? } %>

    <%# Nếu đang edit (persisted), thêm hidden field để vẫn gửi subject_id lên server %>
    <%= f.hidden_field :subject_id, value: @student_score.subject_id if @student_score.persisted? %>
  </div>


  <div>
    <%= f.label :score1 %>
    <%= f.number_field :score1, step: 0.1 %>
  </div>

  <div>
    <%= f.label :score2 %>
    <%= f.number_field :score2, step: 0.1 %>
  </div>

  <%= f.submit %>
<% end %>